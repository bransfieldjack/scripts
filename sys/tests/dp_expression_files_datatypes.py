import os, tarfile
import glob
import re
import numpy as np
import pandas as pd
import functools 
import csv
import pymongo
from pymongo import MongoClient

def main():

    all_s4m_datasets = ['6473', '7415.0', '7387.0', '6992', '7010', '6336', '6252', '6880', '5031', '6213', '5001', '6228', '6053', '6120', '6730', '7336', '7272', '6277', '6887', '6769', '6047', '6344', '6357', '7239', '7241', '6741', '7046', '6954', '6593', '6006', '6071', '6724', '6562', '6300', '7027', '6306', '6349', '6582', '7128', '5024', '6991', '7171', '7218', '7271', '6831', '7148', '6696', '6156', '6576', '6162', '6845', '6087', '6936', '6245', '6830', '6286', '6602', '6557', '7059', '6085', '1000', '7242', '6131', '5029', '6583', '5005', '6714', '6444', '6534', '6795', '6149', '6530', '7277', '6735', '6079', '5021', '6932', '6864', '7350', '7330', '6057', '7228', '7045', '7053', '7072', '6558', '6625', '5035', '6711', '5019', '7291', '7161', '6285', '6074', '6110', '6688', '7160', '6058', '7331', '7096', '6056', '6146', '7339', '6450', '6183', '7254', '7166', '7243', '6052', '7217', '6062', '6049', '6459', '6145', '7036', '6633', '7351', '6710', '7268', '6111', '6033', '6783', '6343', '7401', '7139', '6468', '5006', '6109', '6559', '6135', '6152', '6089', '6895', '6449', '7206', '7079', '6853', '6271', '6619', '6042', '6542', '7298', '6265', '7248', '6491', '7028', '7198', '6509', '6291', '6269', '6635', '6482', '6037', '5038', '6173', '6043', '7120', '7147', '6463', '7142', '6144', '6898', '6555', '6832', '7308', '7344', '6331', '6207', '6048', '6248', '6194', '6001', '7362', '7329', '6324', '6646', '6332', '6124', '6455', '7065', '7288', '6358', '6749', '7129', '6545', '6322', '6134', '6884', '6609', '6780', '6779', '6413', '6127', '6155', '6687', '6081', '6655', '7117', '6470', '6370', '7023', '6745', '6541', '6435', '7258', '6253', '6750', '7026', '7200', '6147', '6713', '6329', '7168', '6393', '7188', '7135', '6362', '6715', '6231', '5030', '6610', '7224', '7061', '6432', '6382', '6500', '6321', '7357', '7263', '6837', '6238', '6153', '7002', '6055', '5022', '6854', '6101', '6364', '6098', '6233', '7275', '6242', '6296', '3000', '6326', '6716', '7091', '6965', '6943', '6523', '7260', '6748', '7032', '6703', '7205', '7311', '6083', '6829', '6929', '7392', '6656', '6405', '7067', '6347', '6746', '6785', '6796', '6160', '6659', '7250', '6328', '6151', '5027', '6140', '7060', '7320', '5020', '6373', '6273', '6448', '6092', '6172', '6288', '7326', '6776', '6318', '6403', '6756', '6313', '6128', '6075', '6281', '4000', '6185', '6467', '7345', '6544', '7238', '7124', '6787', '7102', '6268', '6166', '6499', '7244', '6158', '7269', '6123', '6051', '7380', '6355', '7130', '6161', '7145', '6201', '6334', '5039', '6599', '6601', '7009', '6254', '7237', '6729', '6086', '7337', '6988', '6064', '6353', '6447', '6169', '6436', '7201', '7073', '6600', '6485', '6981', '6950', '6644', '7192', '7283', '7236', '6466', '6869', '5028', '6855', '6597', '6580', '7003', '6712', '6679', '6395', '5015', '6184', '7193', '6767', '6505', '7084', '6068', '6346', '7172', '7249', '5004', '6733', '6501', '6218', '6216', '7284', '7358', '6798', '6414', '6483', '6731', '5042', '6206', '6198', '6003', '6363', '6199', '7229', '6402', '6622', '7211', '7267', '6825', '6130', '6948', '6865', '7127', '6995', '6747', '5013', '6658', '5023', '6429', '6860', '7088', '7371', '6272', '6309', '7077', '7394', '5008', '6439', '7323', '6701', '6611', '6982', '6170', '6614', '6275', '6627', '7325', '6167', '7131', '6195', '6179', '6021', '6290', '6154', '6371', '7182', '6136', '6303', '7393', '6360', '7064', '6292', '6852', '6631', '6828', '6440', '7169', '7322', '6700', '6293', '7021', '7276', '6572', '7266', '7361', '5041', '7366', '6150', '6498', '5003', '6190', '5012', '7328', '6345', '6247', '6592', '6114', '6454', '6826', '2000', '6518', '6412', '6186', '6270', '6643', '6764', '6070', '6638', '6806', '6157', '6125', '6561', '6307', '6827', '6119', '5033', '6338', '6496', '5025', '7324', '6203', '5032', '6556', '6274', '6193', '7297', '6589', '7159', '6446', '6080', '6066', '6612', '7321', '6584', '6479', '6289', '7376', '6445', '6325', '6315', '7114', '6613', '6181', '6901', '6588', '7227', '6786', '5043', '6143', '7170', '5002', '6208', '6889', '6117', '7004', '6317', '6063', '6452', '6416', '7209', '6310', '6280', '7179', '6237', '7115', '6754', '6004', '6284', '7343', '6008', '6480', '6792', '7290', '6229', '6368', '6637', '6952', '5036', '6197', '6007', '6606', '6927', '6938', '6076', '6297', '7204', '6848', '6009', '6316', '6065', '6276', '6624', '7113', '6266', '7062', '6702', '6320', '6461', '6527', '7313', '7132', '6993', '6168', '6820', '6705', '6778', '7011', '7319', '6834', '7240', '6620', '6514', '7108', '6359', '7194', '6278', '6608', '6000', '6723', '6794', '6035', '7167', '6774', '6399', '6489', '6835', '6453', '7099', '6126', '6223', '6639', '6951', '6823', '6108', '6886', '6490', '6758', '7309', '6763', '7195', '6629', '6366', '6005', '5040', '7378', '6339', '7173', '6850', '7312', '5018', '6222', '7087', '7274', '6385', '7379', '6974', '7017', '6264', '6182', '6072', '6566', '5016', '6761', '6267', '7029', '6896', '6106', '6661', '7253', '6390', '7012', '6502', '6354', '6308', '7264', '6528', '6187', '6088', '6868', '6396', '6652']

    files_on_dp = ['6049', '6336', '6500', '6060', '6105', '6219', '6835', '6490', 
    '6320', '6705', '6416', '7064', '6047', '6644', '7361', '6403', 
    '6370', '6576', '6943', '6691', '6582', '6787', '6343', '6558', 
    '6052', '7099', '7345', '6750', '6145', '6606', '6496', '5035', 
    '6413', '6315', '6064', '6538', '6519', '6865', '7319', '5010', 
    '6954', '6322', '6468', '6525', '7350', '6429', '6518', '7159', 
    '6254', '6008', '6584', '6412', '6303', '6275', '6728', '6353', 
    '7032', '6501', '6485', '6363', '6547', '6460', '5003', '6748', 
    '6054', '6447', '6852', '6650', '6422', '6714', '6823', '6612', 
    '6310', '6733', '6830', '6223', '6472', '6349', '6165', '6291', 
    '6427', '6396', '7046', '6735', '6415', '6505', '6551', '6608', 
    '6231', '6390', '6233', '6559', '6689', '7357', '6204', '6510', 
    '6048', '6880', '6696', '7249', '6173', '6715', '6568', '7130', 
    '6098', '6780', '6869', '6855', '6639', '6454', '6043', '6203', 
    '6514', '7124', '6354', '6832', '6647', '6338', '6534', '6542', 
    '7135', '6442', '6951', '6681', '6710', '6352', '6001', '7059', 
    '6192', '7156', '6312', '6159', '6712', '6744', '7264', '6366', 
    '6489', '6242', '6595', '6373', '7010', '6201', '6539', '6840', 
    '6181', '7028', '7053', '6556', '6965', '5001', '6637', '6614', 
    '6646', '7268', '6616', '6895', '7079', '6330', '6854', '6778', 
    '7096', '6461', '6502', '6709', '6316', '6215', '6247', '6620', 
    '6688', '6271', '6562', '6277', '7088', '6834', '6722', '6602', 
    '6661', '7339', '6825', '6774', '6361', '6713', '6758', '6738', 
    '6795', '7228', '6826', '6455', '6779', '6360', '6619', '7242', 
    '6645', '6625', '6806', '6482', '6088', '6074', '7128', '6794', 
    '7120', '7283', '7097', '6198', '7285', '6121', '6399', '6711', 
    '6238', '7045', '6199', '7129', '6425', '6344', '6786', '6147', 
    '6555', '6339', '6580', '6901', '6297', '6743', '6097', '6424', 
    '6359', '6334', '6275', '6401', '6466', '7200', '7346', '6309', 
    '6759', '6259', '7255', '6031', '7239', '6157', '6479', '6932', 
    '6800', '6974', '6985', '6402', '6635', '6243', '6270', '7113', 
    '6213', '6273', '6535', '6217', '6056', '7062', '6483', '6437', 
    '6991', '6241', '6109', '6009', '7343', '6640', '7114', '7127', 
    '6611', '6218', '6276', '6593', '6035', '6588', '6331', '7393', 
    '6610', '6610', '20170320', '7224', '7194', '6652', '7091', '7060', 
    '6305', '6473', '6190', '6898', '6314', '6651', '6216', '6362', '6235', 
    '6058', '7172', '6656', '7139', '7322', '6440', '7029', '6820', '6195', 
    '6853', '6280', '6037', '6055', '6716', '6211', '6572', '6333', '6143', 
    '6220', '6341', '6703', '6561', '6792', '6365', '6304', '6441', '6065', 
    '6268', '6209', '6589', '6372', '6864', '6212', '6318', '6246', '6355', 
    '6856', '7132', '6601', '6633', '6537', '6439', '6252', '6548', '6286', 
    '7171', '6299', '7292', '7254', '6548', '6586', '6841', '6421', '7274', 
    '7193', '6267', '6527', '6636', '6228', '6469', '6592', '6707', '6253', 
    '6624', '6444', '6126', '6405', '7131', '7023', '6364', '6798', '7102', 
    '7157', '6549', '6697', '6480', '6308', '6896', '7415', '7206', '7003', 
    '7067', '6419', '7070', '6761', '6042', '6313', '6936', '6128', '7229', 
    '6257', '6626', '6828', '6600', '6827', '6293', '6436', '6605', '6452', 
    '6730', '6993', '6767', '6208', '6269', '6700', '6667', '6194', '6631', 
    '6414', '6509', '6426', '7205', '5043', '6701', '6317', '6418', '6833', 
    '6428', '6281', '6467', '6803', '6436', '6161', '6042', '6207', '6108', 
    '6702', '6627', '6183', '6294', '6300', '7195', '6764', '6566', '7312', 
    '6301', '6741', '7376', '6393', '6630', '6449', '7321', '6550', '6769', 
    '6528', '7394', '6453', '7308', '6888', '7257', '6053', '7267', '6420', 
    '6756', '6488', '7188', '6464', '6432', '6325', '6720', '6643', '6988', 
    '6272', '6446', '7378', '6622', '6831', '6033', '6927', '6329', '6747', 
    '6237', '6382', '6554', '6726', '6146', '6964', '7248', '6785', '6144', 
    '6384', '7084', '6962', '6240', '6796', '6275', '6266', '7061', '6658', 
    '6563', '6423', '6292', '6347', '6597', '6119', '6289', '7036', '6992', 
    '6385', '7002', '6374', '6214', '7260', '6581', '6153', '6493', '6435', 
    '6191', '7142', '6648', '7190', '6321', '7379', '6387', '6690', '6745', 
    '6508', '6264', '6290', '6356', '6524', '6938', '6285', '6057', '6520', 
    '6193', '6599', '6234', '6629', '6724', '7313', '7240', '7284', '6731', 
    '6848', '6564', '6324', '6557', '6400', '7286', '7117', '6463', '7320', 
    '6256', '6668', '6587', '6726', '7027', '7017', '6738', '7275', '6638', 
    '6504', '6357', '5037', '6278', '6659', '6886', '6868', '6326', '6248', 
    '6265', '6222', '6284', '7377', '6448', '6296', '6511', '6332', '7011', 
    '7069', '7145', '6262', '6450', '6679', '7026', '6687', '6749', '6229', 
    '6723', '6541', '6545', '6499', '6288', '6459', '6498', '6783', '6470', 
    '6245', '7351', '7241', '6345', '6346', '6491', '6746', '7327', '6553', 
    '6397', '6358', '6371', '6307', '6206', '6328', '6884', '6523', '6544', 
    '7179', '6850', '6829', '7077', '7192', '6395', '6763', '7253', '6168', 
    '6445', '6185', '6306', '6692', '6739', '6494', '6929', '7072', '7021', 
    '6583', '6152', '7110']

    not_in_dp = ['7290', '5024', '6530', '6754', '7324', '7326', '6083', '6086', '6066', '6130', '6184', '6160', '6079', '5032', '6006', '6170', '6089', '7170', '6274', '7009', '6950', '6182', '6114', '5025', '7309', '7288', '6887', '7258', '6110', '7012', '6172', '6952', '7358', '6005', '7243', '7329', '7298', '5015', '7148', '7227', '7266', '6076', '7004', '7291', '6655', '5019', '5021', '7166', '7161', '6981', '6136', '6007', '6154', '7344', '6075', '7323', '7173', '6609', '7211', '4000', '6072', '5020', '7244', '7371', '6070', '5040', '7337', '6149', '7325', '5039', '5028', '5031', '6186', '6117', '7362', '6151', '7201', '7108', '5018', '6197', '6063', '7182', '7250', '6845', '7366', '6062', '6187', '6106', '7401', '5042', '7160', '6068', '7331', '7209', '7276', '6158', '6179', '6120', '6101', '7073', '5041', '6860', '7237', '7169', '5012', '6995', '6080', '6162', '7392', '5016', '6000', '6131', '5029', '5027', '6123', '6156', '6004', '7217', '7336', '6125', '5006', '7263', '6837', '7271', '6150', '6169', '5023', '7167', '6948', '6081', '6167', '6071', '7238', '6166', '2000', '6003', '6134', '6889', '7330', '6140', '7115', '5022', '7387.0', '6087', '6729', '7065', '7415.0', '7269', '5038', '6982', '7147', '6127', '6155', '7218', '6111', '6613', '7236', '6021', '6368', '5030', '7328', '7380', '5002', '7087', '7168', '6092', '7297', '5004', '5033', '5008', '7204', '7272', '6135', '5005', '6085', '7277', '7311', '6776', '5013', '6124', '7198', '3000', '6051', '5036', '1000']


    MONGO_URI='mongodb://localhost:27017'
   
    myclient = pymongo.MongoClient(MONGO_URI) 
    database = myclient["dataportal_prod_meta"]
    collection = database["datasets_datatypes"]
    cursor = collection.find({})

    _list = []
    for cur in cursor:

        ds_id = str(cur['dataset_id'])
        data_type = cur['data_type']

        if ds_id in files_on_dp:
            _dict = {
                'dataset_id': ds_id,
                'data_type': data_type,
                'in_dataportal': 'true'
            }
            _list.append(_dict)

        if ds_id in not_in_dp:
            _dict = {
                'dataset_id': ds_id,
                'data_type': data_type,
                'in_dataportal': 'false'
            }
            _list.append(_dict)

    dataframe = pd.DataFrame(_list)
    dataframe.to_csv('/mnt/c/Users/jack/Desktop/scripting/sys/tests/datatypes.tsv', sep = '\t')
    print(dataframe)

    # test = list(set(all_s4m_datasets)-set(files_on_dp))

    # print(test)

    # result: 

    # not_in_dp = ['7290', '5024', '6530', '6754', '7324', '7326', '6083', '6086', '6066', '6130', '6184', '6160', '6079', '5032', '6006', '6170', '6089', '7170', '6274', '7009', '6950', '6182', '6114', '5025', '7309', '7288', '6887', '7258', '6110', '7012', '6172', '6952', '7358', '6005', '7243', '7329', '7298', '5015', '7148', '7227', '7266', '6076', '7004', '7291', '6655', '5019', '5021', '7166', '7161', '6981', '6136', '6007', '6154', '7344', '6075', '7323', '7173', '6609', '7211', '4000', '6072', '5020', '7244', '7371', '6070', '5040', '7337', '6149', '7325', '5039', '5028', '5031', '6186', '6117', '7362', '6151', '7201', '7108', '5018', '6197', '6063', '7182', '7250', '6845', '7366', '6062', '6187', '6106', '7401', '5042', '7160', '6068', '7331', '7209', '7276', '6158', '6179', '6120', '6101', '7073', '5041', '6860', '7237', '7169', '5012', '6995', '6080', '6162', '7392', '5016', '6000', '6131', '5029', '5027', '6123', '6156', '6004', '7217', '7336', '6125', '5006', '7263', '6837', '7271', '6150', '6169', '5023', '7167', '6948', '6081', '6167', '6071', '7238', '6166', '2000', '6003', '6134', '6889', '7330', '6140', '7115', '5022', '7387.0', '6087', '6729', '7065', '7415.0', '7269', '5038', '6982', '7147', '6127', '6155', '7218', '6111', '6613', '7236', '6021', '6368', '5030', '7328', '7380', '5002', '7087', '7168', '6092', '7297', '5004', '5033', '5008', '7204', '7272', '6135', '5005', '6085', '7277', '7311', '6776', '5013', '6124', '7198', '3000', '6051', '5036', '1000']

if __name__ == "__main__":
    main()


